<div class="sessions" *ngIf="conversations && conversations.length > 0;else nosessions">
  <div class="left-pane flex-column" [ngClass]="!isMessageView ? 'conv-view': ''">
    <div class="header">
      <div class="search">
        <textarea type="text" rows="1" placeholder="Search" [(ngModel)]="sessionsFilter"></textarea>
      </div>
    </div>
    <div class="body">
      <mat-selection-list [multiple]="false">
        <mat-list-option *ngFor="let c of conversations | sessions:sessionsFilter:'user_name' | orderbyDate:'updated_at'" [value]="c" class="user-list" (click)="getSession(c); isMessageView = !isMessageView;" [ngClass]="getMatListClasses(c.id)">
          <div class="user-li">
            <mat-icon class="user-icon" font-size="small" aria-hidden="false" aria-label="Example home icon">person</mat-icon>
            <div class="pl-3 flex-column user-right">
              <span class="user-title">{{c.user_name | titlecase}}</span>

              <div class="user-right-top">
                <span class="text-secondary text-truncate last-msg" [title]="c.last_message.message" [hidden]="c.last_message.message == ''"><small>{{c.last_message.sender_type}}: {{c.last_message.message}}</small></span>
                <span class="user-date text-secondary"><small>{{c.updated_at | chatDate}}</small></span>
              </div>
            </div>
          </div>
        </mat-list-option>
      </mat-selection-list>
    </div>
  </div>
  <div class="right-pane flex-column" [ngClass]="isMessageView ? 'message-view': ''">
    <div class="header">
      <button mat-button (click)="isMessageView = !isMessageView;" class="p-0 text-left back-btn mr-2">
        <mat-icon class="back-conv">keyboard_arrow_left</mat-icon>
      </button>
      <mat-icon class="user-icon-right" font-size="small" aria-hidden="false" aria-label="Example home icon">person</mat-icon>
      <span class="user-name-right">{{selectedSession.user_name}}</span>
      <div class="enable-chat" *ngIf="chatList && chatList.length > 0">
        <button mat-stroked-button color="primary" *ngIf="!isEnableAdmin;else disableTemplate" (click)="isEnableAdmin = true; enableAdmin(selectedSession, 'admin')">Enable admin chat</button>
        <ng-template #disableTemplate>
          <button mat-stroked-button color="warn" (click)="isEnableAdmin = false; enableAdmin(selectedSession, 'bot')">Disable admin chat</button>
        </ng-template>
      </div>
    </div>
    <div class="body flex-column">
      <div class="chat-body" #scrollMe>
        <mat-list>
          <mat-list-item class="vf-chat-li" *ngFor="let ch of chatList" [ngClass]="(ch.sender_type=='User')?'vf-chat-li-left':'vf-chat-li-right'">
            <div mat-line>
              <mat-card
                [ngClass]="calculateClasses(ch)">
                {{ch.message}}
              </mat-card>
            </div>
          </mat-list-item>
        </mat-list>
      </div>
      <div class="chat-footer" *ngIf="isEnableAdmin">
        <div class="chat-input-area">
          <textarea type="text" rows="1" placeholder="Type a message" [(ngModel)]="adminMsg" (keydown.enter)="sendMessage($event)"></textarea>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #nosessions>
  <div class="sessions text-center">
    <h6 class="flex-fill text-center pt-5">No sessions at this time!</h6>
  </div>
</ng-template>
